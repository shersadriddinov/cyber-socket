## Новый вид конфигов

Теперь конфиги состоят из персонажа, первичного, вторичного оружия и булевой флага `current` показывающего текущее в **User Info**. Все элементы внутри `character`, `primary` и `secondary` идут по глобальным `id`, т.е. "weapon": 199 означает, что там используется оружие с id=199 из глобального списка оружия. *На поле `id` внутри `primary` и `character` не обращайте внимание, они нужны, мне для промежуточных операций*

```json
{
    "id": 53,
    "current": true,
    "date_created": "2020-12-03T22:16:51.171248+05:00",
    "character": {
        "id": 3,
        "tech_name": "CyborgRoman",
        "default": true,
        "hidden": false,
        "date_created": "2020-04-19T01:41:36.848390+05:00"
    },
    "primary": {
        "id": 11,
        "weapon": 199,
        "stock": 2,
        "barrel": 2,
        "muzzle": 2,
        "mag": 2,
        "scope": 3,
        "grip": 2
    },
    "secondary": {
        "id": 12,
        "weapon": 198,
        "stock": null,
        "barrel": null,
        "muzzle": null,
        "mag": null,
        "scope": null,
        "grip": null
    }
}
```

С новой схемой вам достаточно помечать всего один конфиг как `current` как `true`, и он сам даст оба первичных и вторичных оружия, достаточно лишь создавать конфиги.



#### Важно! теперь в API не выдаются стартовые вторичные оружия`start_weapons_second_slot`, теперь любое вторичное оружие будет автоматом добавляться к каждому пользователю



Учитывая последние изменения, регистрация нового пользователя выглядит так:

1. Пользователь проходит `auth/` и получает список `start_characters` и `start_weapons_first_slot`

2. По запросу `user/setchar/{character id}/` он даёт юзеру одного из стартовых персонажей И создаёт первый конфиг игрока с этим персонажем и `current = true` . Его уже начнёт отдавать в запросе User Info

3. По запросу user/setweap/{weapon id}/ он даёт юзеру одно из стартовых оружий И добавляет в конфиг из 2 шага это оружие как primary. Оружие тоже начнёт отдавать в User Info как `weapon_first_slot`

4. Дальше для полноты юзеру остаётся только выбрать себе что-то из вторичного, которое уже добавилось ему по умолчанию.

   - Делайте запрос на  список вторичного оружия юзера `weapon/list?user_only=1&slot=1` 

   - По id из прошлого шага делайте запрос на получение информации об этом оружии юзера `weapon/11/?user_only=1` , что бы взять оттуда нужные себе аддоны

   - Делайте запрос на все конфиги пользователя `user/config/list/` и берём id нужного конфига

   - Делайте **PUT** запрос на изменение этого конфига, `user/config/{config id}/` и в body запроса отправляем json на изменение поля `secondary`

     ```json
     "secondary": {
             "weapon": 11,
             "stock": null,
             "barrel": null,
             "muzzle": null,
             "mag": null,
             "scope": null,
             "grip": null
         }
     ```

### Также можно создавать, изменять, получать и удалять любые конфиги по старым запросам, но с новой структурой

+ **POST** Создать конфиг

  Отправляем json на `user/config/list/` с вот такой структурой. В этом запросе важно отправлять каждое поле, если есть отсутствующие заменять на `null` 

  ```json
  {
      "character": 3,
      "current": false,
      "primary": {
          "weapon": 11,
          "stock": 1,
          "barrel": 1,
          "muzzle": 1,
          "mag": 1,
          "scope": 1,
          "grip": 1
      },
      "secondary": {
          "weapon": 11,
          "stock": 2,
          "barrel": 2,
          "muzzle": 2,
          "mag": 2,
          "scope": 2,
          "grip": 3
      }
  }
  ```

+ **PUT** Изменить конфиг

  Отправить json на `/user/config/{id config}/` , отправлять только параметры которые хотите поменять. Например этот запрос можно использовать, чтобы сменить основное конфиг игрока из User Info

  ```json
  {
      "current": true
  }
  ```

+ **GET** получить инфо о конфиге по id

  `user/config/{config id}/`

+ **DELETE** удалить конфиг по id

  `user/config/{config id}/`